function randomNumber(e,a){return Math.floor(Math.random()*(a-e))+e}function randomFrom(e){return e[Math.floor(Math.random()*e.length)]}function shuffle(e){for(var a,t,s=e.length;s;a=Math.floor(Math.random()*s),t=e[--s],e[s]=e[a],e[a]=t);return e}function addCommas(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function findInArray(e,a){let t=e.indexOf(a);return t>-1?t:null}function removeFromArray(e,a){for(var t=e.length-1;t--;)e[t]==a&&e.splice(t,1)}function percentOf(e,a){return 0==e||0==a?0:Math.round(100*a/e)}function sendEvent(e,a,t,s){s?(_paq.push(["trackEvent",e,a,t,s]),console.log("CATEGORY: "+e+", ACTION:"+a+", LABEL:"+t+", VALUE:"+s)):t?(_paq.push(["trackEvent",e,a,t]),console.log("CATEGORY: "+e+", ACTION:"+a+", LABEL:"+t)):(_paq.push(["trackEvent",e,a]),console.log("CATEGORY: "+e+", ACTION:"+a))}var app=new Vue({el:"#app",data(){return{stats:{general:{},cameo:{},invalid:{},wrongest:{}},columns:{playerNames:[{label:"Player Name",field:"iname",tdClass:"player-name-cell"},{label:"Played",field:"icount",type:"number"},{label:"Last Played",field:"lastPlayed",tdClass:"last-played-cell"}],celebs:[{label:"Name",field:"cameoName"},{label:"Actual Value",field:"actualValue",type:"number",formatFn:this.dollars},{label:"Avg Value",field:"averageValuation",type:"decimal",formatFn:this.dollars},{label:"Market Forces",field:"marketForces",type:"decimal",formatFn:this.dollars},{label:"Sort Score",field:"sortScore",type:"number"},{label:"Birthdays",field:"birthdayWishes",type:"number"}],cameoPlayers:[{label:"Score",field:"playerScore",type:"number"},{label:"Sorts",field:"correctSorts",type:"number"},{label:"Value Offset",field:"averageValuationOffset",type:"number",formatFn:this.dollars},{label:"Blew Budget",field:"exceededBudget",formatFn:this.exceededBudgetOutput},{label:"Finished",field:"finishTime",type:"date",formatFn:this.formatDate}],bugs:[{label:"Bug",field:"iname"},{label:"Deployed",field:"icount",type:"number"}],challenges:[{label:"Challenge",field:"iname"},{label:"Played",field:"icount",type:"number"}],letters:[{label:"Letter",field:"letter"},{label:"Banned",field:"banned",type:"number"},{label:"Demanded",field:"demanded",type:"number"}],passwords:[{label:"Password",field:"password"},{label:"Challenge",field:"challenge"},{label:"Used",field:"used",type:"number"},{label:"Cracked",field:"cracked",type:"number"},{label:"Crashed",field:"crashed",type:"number"}],playerCounts:[{label:"Game Type",field:"iname"},{label:"Played",field:"icount",type:"number"}],rules:[{label:"Rule",field:"iname"},{label:"Deployed",field:"icount",type:"number"}],wrongestStatements:[{label:"Statement",field:"iname",formatFn:this.formatStatement},{label:"Total Score",field:"icount",type:"number"}],decks:[{label:"Deck",field:"iname"},{label:"Played",field:"icount",type:"number"}]},ui:{viewing:"loading",cameoLoaded:!1,invalidLoaded:!1,wrongestLoaded:!1}}},methods:{getData(e){const a=this;a.ui.viewing="loading";let t=new URL(location.protocol+"//"+location.host+location.pathname);t.searchParams.set("game",e),"cameo"==e?axios.get("/stats/live/cameo/json").then((function(e){a.stats.cameo=e.data})).catch((function(e){console.log(e)})).then((function(){a.stats.cameo.celebScores.forEach((e=>{e.cameoName&&a.stats.cameo.celebs.push({cameoName:e.cameoName,actualValue:0,sortScore:e.sortScore,birthdayWishes:e.birthdayWishes,valuations:0,totalValuation:0,averageValuation:0,marketForces:0})})),a.stats.cameo.valuations.forEach((e=>{let t=a.stats.cameo.celebs.find((a=>a.cameoName==e.cameoName));t&&e.actualValue&&e.playerValue&&e.playerValue<2e3&&(0==t.actualValue?(t.actualValue=e.actualValue,t.totalValuation=e.playerValue,t.valuations=1,t.averageValuation=t.totalValuation):t.actualValue&&(t.totalValuation+=e.playerValue,t.valuations+=1,t.averageValuation=t.totalValuation/t.valuations)),a.stats.cameo.celebs.forEach((e=>{e.marketForces=e.averageValuation-e.actualValue})),a.ui.cameoLoaded=!0,a.ui.viewing="cameo"}))})):"invalid"==e?axios.get("/stats/live/invalid/json").then((function(e){a.stats.invalid=e.data})).catch((function(e){console.log(e)})).then((function(){a.stats.invalid.successfulPasswords.forEach((e=>{e.iname&&a.stats.invalid.passwords.push({password:e.iname,challenge:e.challenge,used:e.icount,cracked:0,crashed:0})})),a.stats.invalid.cracks.forEach((e=>{let t=a.stats.invalid.passwords.find((a=>a.iname==e.password));t?t.cracked=e.icount:a.stats.invalid.passwords.push({password:e.iname,challenge:"",used:0,cracked:e.icount,crashed:0})})),a.stats.invalid.crashes.forEach((e=>{let t=a.stats.invalid.passwords.find((a=>a.iname==e.password));t?t.crashed=e.icount:a.stats.invalid.passwords.push({password:e.iname,challenge:"",used:0,cracked:0,crashed:e.icount})})),a.stats.invalid.demandedLetters.forEach((e=>{e.iname&&a.stats.invalid.letters.push({letter:e.iname,demanded:e.icount,banned:0})})),a.stats.invalid.bannedLetters.forEach((e=>{let t=a.stats.invalid.letters.find((a=>a.letter==e.iname));t?t.banned=e.icount:a.stats.invalid.letters.push({letter:e.iname,demanded:0,banned:e.icount})})),a.ui.invalidLoaded=!0,a.ui.viewing="invalid"})):"wrongest"==e&&axios.get("/stats/live/wrongest/json").then((function(e){a.stats.wrongest=e.data})).catch((function(e){console.log(e)})).then((function(){a.ui.wrongestLoaded=!0,a.ui.viewing="wrongest"})),window.history.pushState({},"",t)},formatTime:(e,a)=>"fromNow"==a?moment(e).subtract("6","hours").fromNow():"calendar"==a?moment(e).diff(moment(),"days")>-7?moment(e).subtract("6","hours").calendar():moment(e).subtract("6","hours").format("MMM Do @ LT"):a?moment(e).subtract("6","hours").format(a):moment(e).subtract("6","hours").format("LLLL"),addCommas:e=>addCommas(e),dollars(e){const a=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2});return e?a.format(e):"-"},formatDate:e=>e?moment(e).subtract("6","hours").format("MMM Do @ h:ss a"):"",percentOf:(e,a)=>percentOf(e,a),formatStatement:e=>e.replace("{","").replace("}",""),exceededBudgetOutput:e=>"YES"==e||"NO"==e?e:"-"},computed:{computedCameoPlayerData(){let e={averagePoints:0,averageCorrectSorts:0,averageBirthdayWishes:0,exceededBudget:0,observedBudget:0,exceededBudgetPercent:0,correctSortPercent:0};const a=this;if(!a.stats.cameo.playerScores||a.stats.cameo.playerScores.length<10)return e;let t=0,s=0,l=0;a.stats.cameo.playerScores.forEach((a=>{t+=a.playerScore,s+=a.correctSorts,l+=a.birthdayWishes,"no"==a.exceededBudget||("NO"==a.exceededBudget?e.observedBudget++:"YES"==a.exceededBudget&&e.exceededBudget++)}));let n=a.stats.cameo.playerScores.length;return e.averagePoints=parseInt(t/n),e.averagePoints=addCommas(e.averagePoints),e.averageCorrectSorts=parseInt(s/n),e.averageBirthdayWishes=parseInt(l/n),e.exceededBudgetPercent=percentOf(e.observedBudget+e.exceededBudget,e.exceededBudget),e.correctSortPercent=percentOf(12,e.averageCorrectSorts),e},computedNaughtyPercentage(){const e=this;return e.stats.general&&e.stats.general.invalid&&e.stats.general.invalid.NaughtyModeOn?percentOf(e.stats.general.invalid.NaughtyModeOn+e.stats.general.invalid.NaughtyModeOff,e.stats.general.invalid.NaughtyModeOn):"0"},computedCrackedPasswordPercent(){const e=this;return e.stats.invalid&&e.stats.invalid.successfulPasswords&&e.stats.invalid.cracks?percentOf(e.stats.invalid.successfulPasswords.length,e.stats.invalid.cracks.length):"0"},computedServerCrashes(){const e=this;if(!e.stats.invalid||!e.stats.invalid.crashes)return"0";let a=0;return e.stats.invalid.crashes.forEach((e=>{a+=e.icount})),a},computedAvgMarketForces(){const e=this;if(!e.stats.cameo||!e.stats.cameo.celebs)return"0";let a=0,t=0;e.stats.cameo.celebs.forEach((e=>{a++,t+=e.marketForces}));let s=t/a;return e.dollars(s)}},created:function(){const e=this;axios.get("/stats/live/general/json").then((function(a){e.stats.general=a.data})).catch((function(e){console.log(e)})).then((function(){e.ui.viewing="general"}))}});